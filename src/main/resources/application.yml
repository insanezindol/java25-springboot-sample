spring:
  application:
    name: java25-springboot-sample

  # 가상 스레드 설정
  threads:
    virtual:
      enabled: true

  # MySQL 데이터소스
  datasource:
    url: jdbc:mysql://${MYSQL_HOST:localhost}:${MYSQL_PORT:3306}/${MYSQL_DATABASE:devdb}?allowPublicKeyRetrieval=true&useSSL=false&serverTimezone=Asia/Seoul&characterEncoding=UTF-8
    username: ${MYSQL_USER:devuser}
    password: ${MYSQL_PASSWORD:devpassword}
    driver-class-name: com.mysql.cj.jdbc.Driver
  jpa:
    hibernate:
      ddl-auto: update        # dev: update, prod: validate
    show-sql: false
    properties:
      hibernate:
        format_sql: true

  # Redis (Spring Data Redis)
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:redispassword}
      database: 0  # 0-15 사이의 DB 인덱스 (기본값: 0)
      timeout: 2000ms  # 연결 타임아웃
      connect-timeout: 1000ms  # 커넥션 타임아웃
      client-type: lettuce  # 또는 jedis

  # Elasticsearch (Spring Boot 2.3+ / 3.x 설정)
  elasticsearch:
    uris: ${ELASTICSEARCH_URIS:http://localhost:9200}
    username: ${ELASTIC_USERNAME:}
    password: ${ELASTIC_PASSWORD:}
    connection-timeout: 10s
    socket-timeout: 30s

  # Kafka (producer + consumer)
  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
    consumer:
      group-id: ${KAFKA_CONSUMER_GROUP:app-group}
      auto-offset-reset: earliest
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      enable-auto-commit: true
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.apache.kafka.common.serialization.StringSerializer

# Spring Actuator / Prometheus 설정
management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus
  endpoint:
    health:
      show-details: always
  prometheus:
    metrics:
      export:
        enabled: true
  health:
    elasticsearch:
      enabled: false  # ES 헬스 체크만 비활성화

# Swagger / OpenAPI 설정
springdoc:
  swagger-ui:
    path: /swagger-ui.html    # 접근 주소
    groups-order: DESC
    operations-sorter: method
    disable-swagger-default-url: true
    display-request-duration: true
  api-docs:
    path: /v3/api-docs
  default-consumes-media-type: application/json
  default-produces-media-type: application/json

kafka:
  topic:
    event: user-events
